{% extends 'base.html' %}

{% block content %}

<body style="color: {{ cv.primary_color }}; font-family: {{ cv.font_family }};">

  {% if cv.header_image %}
  <img src="{{ cv.header_image.url }}" class="img-fluid mb-4" alt="Header Image">
  {% endif %}

  <div class="d-flex justify-content-between align-items-center my-3">
    <a href="{% url 'download_cv_pdf' slug=cv.slug %}" class="btn btn-success">📄 Descargar PDF</a>
    <a href="{% url 'cv_list' %}" class="btn btn-danger">❌ Cancelar</a>
  </div>

  {% if profile %}
  <div class="border rounded p-3 mb-4 bg-light">
    <h5 class="text-secondary">👤 Información del Perfil</h5>
    <p><strong>Nombre:</strong> {{ profile.user.first_name }} {{ profile.user.last_name }}</p>
    <p><strong>Email:</strong> {{ profile.user.email }}</p>
    <p><strong>Teléfono:</strong> {{ profile.phone|default:"No especificado" }}</p>
  </div>
  {% endif %}

  <h1 class="text-center my-4">{{ cv.title }}</h1>

  {% if cv.selected_experiences.all %}
  <div class="section mb-4">
    <h2>📌 Experiencias</h2>
    <table class="table table-striped table-sm">
      {% for exp in cv.selected_experiences.all %}
      <tr>
        <td><strong>{{ exp.position }}</strong></td>
        <td>{{ exp.company }}</td>
        <td><small>{{ exp.start_date }} – {{ exp.end_date|default:"Actualidad" }}</small></td>
      </tr>
      {% endfor %}
    </table>
  </div>
  {% endif %}

  {% if cv.selected_educations.all %}
  <div class="section mb-4">
    <h2>🎓 Formación</h2>
    <table class="table table-bordered table-sm">
      {% for edu in cv.selected_educations.all %}
      <tr>
        <td>{{ edu.title }}</td>
        <td>{{ edu.institution }}</td>
      </tr>
      {% endfor %}
    </table>
  </div>
  {% endif %}

  {% if cv.selected_languages.all %}
  <div class="section mb-4">
    <h2>🌍 Idiomas</h2>
    <table class="table table-hover table-sm">
      {% for lang in cv.selected_languages.all %}
      <tr>
        <td>{{ lang.language.name }}</td>
        <td>{{ lang.level }}</td>
      </tr>
      {% endfor %}
    </table>
  </div>
  {% endif %}

  {% if cv.selected_softskills.all %}
  <div class="section mb-4">
    <h2>💡 Habilidades Blandas</h2>
    <ul class="list-unstyled">
      {% for skill in cv.selected_softskills.all %}
      <li>• {{ skill.skill.name }}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}

  {% if cv.selected_hobbies.all %}
  <div class="section mb-4">
    <h2>🎯 Hobbies</h2>
    <ul class="list-unstyled">
      {% for h in cv.selected_hobbies.all %}
      <li>• {{ h.hobby.name }}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}

</body>

{% endblock %}